# any_pic_2_jpg_or_png


＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
【2025年08月24日】版本已升级为v1.13

虽然改动了代码，但操作方法不变。

依旧兼容win7（64位）。

根据我的另一篇帖子：
【Python】Windows上创建文件时进行空间预分配，使之具有连续非碎片化空间的正确方法
https://www.52pojie.cn/thread-2054992-1-1.html

对输出文件的预分配机制进行了大幅改进，这次彻底摆脱了管理员权限，
而且可以防止老版本使用的fsutil在FAT32、exFAT上因为强制“填零”导致的卡顿和写入放大，
因此不再需要安装用于绕过UAC弹窗的计划任务了，
也去掉了原先为了管理员权限设置的启动器和各种繁杂的机制，代码变简单了。

之后我会删掉操作演示中关于UAC的片段以及后面的一部分代码展示，因为用不到了，
外加摆烂不想重新录一期操作演示。

★★ 替换新版前记得用老版v1.12的“绕过UAC弹窗【安装／卸载】.bat”
     删掉曾经安装的计划任务，或者手动进系统计划任务里清除。

原先只有文件数据确认没发生变动的场景下（livp、华为动态图片……）才会转移修改时间，
现在改为全部转移修改时间。

原先大小为零的空文件因为无法使用mmap会被判定为“转换失败”，
现在增加了判断是否为空文件，空文件现在会被标记为“跳过”。

新增了对系统屏幕缩放比例的识别，弹窗文字不会模糊，
弹窗现在全部直接采用tkinter手写代码
（pyautogui不支持对系统屏幕缩放比例的识别，故抛弃），
还增加了弹窗置顶和居中的特性。

新增一项实验性质的功能，
曾经遇到过一位向我求助过heic转换的人，
我发现他发过来的动图mov和heic的扩展名正好是互换颠倒的，
mov由于本身是heic文件，且程序不看扩展名，所以成功转换过来，
但扩展名改为heic的mov文件程序却默认不管扩展名直接复制过来，
造成以为没转换出视频的错觉，
所以新增纠正mov和mp4文件扩展名的功能，不过受制于filetype的识别准确率，
有些mov视频文件可能不会被识别出来。



升级如下python库至右侧版本：
psutil            7.0.0

升级如下第三方库至右侧版本：
ExifTool          13.34


    如果后期没有大的bug或者很有必要加入的新功能的话，

★★【v1.13】依旧很有可能是【最后一个支持win7的版本】★★

PS：不过感觉如果没有特别大的升级念头的话，应该不会开坑win10的版本






＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
【2024年11月11日】版本已升级为v1.12

【核心源码不变】【操作方法不变】

升级如下python库至右侧版本：
psd_tools         1.10.1
pymupdf           1.24.11
crc32c            2.7.1
pywin32           308
pywin32-ctypes    0.2.3
psutil            6.1.0

升级如下第三方库至右侧版本：
ExifTool          13.02

稍微整理了下源码文件夹，方便一键从源码打包程序。

注：由于Python_3.8的寿命周期于2024年10月底到期，pillow、pillow_heif、pymupdf、psd_tools于最近
    均取消了对Python_3.8的支持，还有rawpy库也在一段时间之前已经取消了对Python_3.8的支持，
    上面提到的这些库已经升级到了支持Python_3.8的最高版本。



    如果后期没有大的bug或者很有必要加入的新功能的话，

★★【v1.12】很有可能是【最后一个支持win7的版本】★★


    Python_3.8是支持原生win7的最高的Python版本，再往上的版本其实也不是不能支持，
    只不过估计需要安装各种补丁包和进行各种魔改，考虑到各位的动手能力和各自的电脑软件环境的差别，
    即使能一步步完成魔改，是否能正常运行也是未知数，
    所以后续保险起见，发布新版本的软件时，大概率不会考虑对高版本的Python进行魔改以兼容win7。


    Python_3.8这么早就“凉凉”也是很可惜，软件刚刚发布的时候我还在吹“pillow、pillow_heif一直有人在维护，
    今后的发展很令人期待”的来着，实在没想到打脸来得这么快，这下以后新版本的库不出意外的话只有win10能用了，
    只能跟各位说声抱歉哈。





＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
【2024年10月12日】版本已升级为v1.1

这个版本已经完善好了：UAC绕过、提升权限、进程重复的判断机制，
以及PSD不能转换的问题，目前准备更新教程。

着急的话，可以自己先摸索起来，软件操作大致上没什么变化，
拖放和命令行的操作依旧和以前一样。

新增了非Administrator用户的UAC绕过功能，解压后双击运行“绕过UAC弹窗【安装／卸载】.bat”，
允许UAC弹窗，即可安装绕过UAC的功能，其原理是通过系统自带的计划任务来提升权限。

这个绕过UAC的功能仅针对当前登录用户，原因是系统限制，
需要以当前用户身份才能运行计划任务，否则拒绝访问。

卸载“绕过UAC”功能的时候，直接去系统的计划任务里找到“any_pic_2_skip_UAC_for_user--【用户名】”字样的任务，
删除即可，或者用程序自带的卸载功能（只能删除当前登录用户对应的计划任务）。

新增“系统自带notepad【推荐显示设置】.reg”，双击确定后，
可以让自己电脑上的notepad（系统自带记事本）的显示效果和我这边视频演示的一样，
包括字体、字体大小，可以和演示视频里统一，方便后续用notepad查看日志、设置文件，
主要就是为了一个“养眼”。
